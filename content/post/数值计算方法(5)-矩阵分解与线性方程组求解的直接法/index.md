+++
date = '2024-12-22T15:06:59+08:00'
draft = true
title = '数值计算方法(5) 矩阵分解与线性方程组求解的直接法'

+++

上次讲了线性方程组求解的迭代法，这次理所应得地就是来聊聊直接求解了。

### 约当消去法和高斯消去法

其实线性方程组咱们在线性代数/高等代数里都聊过的，我自己也出了专门的线性方程组求解的专利而且还重制了一版，各位观众应该是比较熟悉了的才对。([线性方程组专栏链接在这里](https://www.bilibili.com/read/cv40034878))

这两个方法其实就是我们之前就会的，什么用初等行变换把矩阵化成行阶梯型行最简型甚至相抵标准型之类的。

就是回带的时间不一样而已，绝当消去法是直接一把梭，消元到行最简型然后直接就能观察出解了，而高斯消去法只消到行阶梯型然后回代解一元一次方程。

所以这两个方法我觉得无需多言（啊，看见这四个字又想玩梗了）。

本文的重点在于利用矩阵分解来求解方程组。

### LU分解

这一切的基石来源于LU分解。

不过在这里我要澄清一个观念。

在线性代数/高等代数里我们强调过，矩阵乘法的几何意义是矩阵对应的线性变换的乘法（也就是复合），所以在这种意义上，所谓的矩阵分解应该是把一个矩阵分解成若干个矩阵的乘积。

而在上文中，我曾经说把一个矩阵A分解为上三角U、下三角L、对角阵D使得A=D-L-U，这不是我们这里说的矩阵分解。这里所谓的分解只是从代数的角度或者说凑数的角度看把一个矩阵拆分成三个矩阵的和，是没有几何意义的。

好，我们现在澄清完了可以开始LU分解的内容了。

LU分解也是一种直接求解的方法，他是这样想的。

我们对AX=b的系数矩阵A进行预处理，把他分解成下三角矩阵L和上三角矩阵U的乘积。

即找一个下三角矩阵L和上三角矩阵U使得A=LU

然后AX=b就是LUX=b，也就是L(UX)=b。

为什么要这么做呢？

因为这样我们可以换元，令y=UX

则Ly=b是轻易求解的，UX=y也是轻易求解的。

例如

$
A=\begin{pmatrix}
1 & 2 & 3 \\
2 & 5 & 2 \\
3 & 1 & 5
\end{pmatrix},b=\begin{pmatrix}
14 \\
18 \\
20
\end{pmatrix}
$

我们可以进行LU分解

$
A=\begin{pmatrix}
1 & 2 & 3 \\
2 & 5 & 2 \\
3 & 1 & 5
\end{pmatrix}=\begin{pmatrix}
1 & 0 & 0 \\
2 & 1 & 0 \\
3 & -5 & 1
\end{pmatrix}\begin{pmatrix}
1 & 2 & 3 \\
0 & 1 & -4 \\
0 & 0 & 24
\end{pmatrix}$

显然前面那个矩阵就是L，后面那个是U。

我们先解Ly=b，从上往下看第一个方程$y_1=14$直接解出来了。

第二个方程$2y_1+y_2=18$，很容易解出$y_2=-10$。

然后是第三个方程$3y_1-5y_2+y_3=20$，解出$y_3=-72$。

果然容易求解吧。

然后求解UX=y

也就是

$\begin{pmatrix}
1 & 2 & 3 \\
0 & 1 & -4 \\
0 & 0 & 24
\end{pmatrix}X=\begin{pmatrix}
14 \\
-10 \\
-72
\end{pmatrix}$

从下往上看，第一个方程$24x_3=-72,x_3=3$，

第二个方程$x_2-4x_3=-10,x_2=2$，

第三方程$x_1+2x_2+3x_3=14,x_1=1$。

现在就很轻易地解出了方程。

但是问题来了，怎么进行LU分解呢？

我们以分解$A=\begin{pmatrix}
4 & 2 & -2 \\
2 & 2 & -2 \\
-2 & -3 & 13
\end{pmatrix}$为例，先进行初等行变换。

但是这里我们只能做把某一行的k倍加到另一行，从而把A化成上三角矩阵。

$A=\begin{pmatrix}
4 & 2 & -2 \\
2 & 2 & -2 \\
-2 & -3 & 13
\end{pmatrix}$

首先，第一行的一半加到第三行，然后第一行的-0.5倍加到第二行，然后你给4 2 -2这三个元素画圈。

你会首先得到矩阵

$\begin{pmatrix}
4 & 2 & -2 \\
0 & 1 & -1 \\
0 & -2 & 12
\end{pmatrix}$

然后再把第二行的2倍加到第三行，给1 -2画圈。

得到

$\begin{pmatrix}
4 & 2 & -2 \\
0 & 1 & -1 \\
0 & 0 & 10
\end{pmatrix}$

这个就是U了，当然最后记得给10画圈。

那L呢？

我们只做了初等行变换对吧，我们知道给矩阵做初等行变换等价于在左边左乘一系列初等矩阵，L就是这些初等矩阵的乘积。

为了保证这些初等矩阵的乘积是下三角矩阵所以我们才要求你只能做把某一行的k倍加到另一行这一种变换。

那么这个L要不要自己手动去整理一下找到我们乘了哪些初等矩阵然后再计算乘积呢？不用这么麻烦。

前面不是让你画圈了吗？

你把画圈的元素拼起来，得到

$\begin{pmatrix}
4 & 0 & 0 \\
2 & 1 & 0 \\
-2 & -2 & 10
\end{pmatrix}$

这个矩阵，还不是L啊哈哈。

我们得到的L比这个还要强其实。

我们的L是一个单位下三角！

你要做的是，每一列乘以某个数把他变成单位下三角，也就是第一列除以4，第二列除以1，第三列除以10得到

$\begin{pmatrix}
1 & 0 & 0 \\
\frac{1}{2} & 1 & 0 \\
-\frac{1}{2} & -2 & 1
\end{pmatrix}$

这个才是L。

我们这里分解出来的L是单位下三角，其实你也可以分解出单位上三角。

换言之，LU分解是不唯一的。你也可以分解成两个普通的上下三角矩阵。

所以为了保证分解的唯一性，我们会要求L或者U的其中一个是单位上下三角。

如果L是单位下三角这样的分解叫Doolittle分解，U是单位上三角则这样的分解是Crout分解。

### Choloesky分解

除了LU分解之外还有办法。

不过我们得给矩阵A加一些条件了。我们要求A是正定阵。

如果A是正定矩阵我们会得到特殊的结论。

先对A进行一次LU分解，A=LU'，接着如果我们对U'再次进行LU分解，你会得到$U’=DL^T$。

所以正定矩阵A可以分解为$LDL^T$。

这个就是Choloesky分解。

其中D很特殊，D是一个对角阵，也就是说$U'$的LU分解分解出的下三角矩阵是一个对角阵而L是单位下三角矩阵。

所以你应该意识到，两次LU分解进行的是不同的LU分解，第一次把L分解为单位下三角，也就是进行Doolittle分解，此时U‘是一般的上三角矩阵。

然后对U'进行Crout分解，把分解出来的上三角化为单位上三角并且这个单位上三角刚好是$L^T$，此时下三角矩阵刚好是对角阵。

所以如果是正定矩阵，你可以对A先进行一次LU分解，得到L，那么他的Choloesky分解里就只有对角阵D不知道了。

而对角阵D其实也是很容易就知道的。

因为U’你是知道的，而$U'=DL^T$，我们可以用这个关系得到D。

例如$A=\begin{pmatrix}
3 & 2 & 3 \\
2 & 2 & 0 \\
3 & 0 & 12
\end{pmatrix}$

进行一次LU分解得到

![LU分解.png](https://27ed0b40.cloudflare-imgbed-bo7.pages.dev/file/1734853862664_LU分解.png)

哦对了，这个是[这个网站](https://matrixcalc.org/zh-CN/#LU-decomposition%28%7B%7B2,-1,1%7D,%7B-1,-2,3%7D,%7B1,3,1%7D%7D%29)计算得到的。（网址https://matrixcalc.org/zh-CN/)

然后我们知道L和U'了

由于U'=DL，你可以先用待定系数法求D。

自己试试看，然后你就会发现好像不用那么麻烦了。

因为

$U'=\begin{pmatrix}
d_{11} & 0 & 0 \\
0 & d_{22} & 0 \\
0 & 0 & d_{33}
\end{pmatrix}\begin{pmatrix}
1 & \frac{2}{3} & 1 \\
0 & 1 & -3 \\
0 & 0 & 1
\end{pmatrix}$

我们只算U’的对角元。

第一行乘第一列，就是$d_{11}$

第二行乘以第二列就是$d_{22}$

第三行乘以第三列就是$d_{33}$

所以D的对角元是啥？不就是U‘的对角元？所以D也可以直接看出来。

### 平方根法（平方分解）

由Cholesky分解还可以进一步得到平方分解。

对于正定矩阵A它可以分解为$LDL^T$

但是D也可以进一步拆分啊。

再构造一个对角阵$D'=diag(\sqrt{d_{11}},\sqrt{d_{22}},...,\sqrt{d_{nn}})$

那么D就可以看作是$D'D'^T$

所以$A=LDL^T=LD'D'^TL^T=(LD')(LD')^T$

如果我设$L'=LD'$则$A=L'L'^T$

此时我们说$L'=\sqrt A$

这就是A的平方根分解。

只不过，相比于上一种方法这个方法其实计算量更大。

这个叫平方根法，前面那种方法我们叫改进平方根法。

啊哈哈，这次反而是先推出改进版的方法。

### 追赶法

之前我们就说过，三对角矩阵可以用追赶法来求解。

现在重要可以来唠唠追赶法了。

追赶法其实就是对三对角矩阵的LU分解。

但是三对角矩阵的LU分解也是特殊的。

例如计算

$A=\begin{pmatrix}
2 & -1  \\
-1 & 2 & -1 \\
 & -1 & 2 &-1 \\& & -1 &2 &-1\\& & & -1 &2 \end{pmatrix}$

它的L一定是这样的形式

$L=\begin{pmatrix}
\alpha_1 &   \\
-1 & \alpha_2  \\
 & -1 & \alpha_3  \\& & -1 &\alpha_4 \\& & & -1 &\alpha_5 \end{pmatrix}$

其中最下面那排-1啊，是和A的最下面那排一样的。

A的U啊，是单位上三角

$U=\begin{pmatrix}
1 & \beta_1  \\
 & 1 & \beta_2 \\
 &  & 1 &\beta_3 \\& &  &1 &\beta_4\\& & &  &1 \end{pmatrix}$

那么关键就是证明求$\alpha_i$和$\beta_i$了呗。

方法是直接把LU相乘，毕竟LU=A嘛

L的第一行乘以U第一列得到$\alpha_1=2$

然后我们再算$\beta_1$

也就是L的第一行乘以U的第二列，得到$\beta_1$

然后我们算$\alpha_2$

用L的第二行乘以U的第二列。

以此类推。

你会发现我们是先算$\alpha_i$再算$\beta_i$

所以形象的说就是有个追赶的过程。

因此这个方法的名字叫追赶法。

至于你说，我不想用矩阵乘法这么麻烦来算，其实这玩意儿有公式，但是我个人觉得反而更麻烦了，而且公式很难记忆，想知道的话还是自己上网查吧。

到这里呢，常见的数值计算方法就罗列得差不多了，剩下来还有一个函数逼近的，什么最小二乘啊之类的，这个有空再更新吧，该换换胃口了。

天天搞这个我会疯掉的。

